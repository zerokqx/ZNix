#!/usr/bin/env bash

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
DIR="${ROFI_SCREENSHOT_DIR:-$HOME/Pictures/Screenshots}"
mkdir -p "$DIR"

# –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã
DATE_FORMAT="${ROFI_SCREENSHOT_DATE_FORMAT:-+%Y-%m-%d-%H-%M-%S}"

# –§–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
FILE="$DIR/$(date "$DATE_FORMAT").png"

# –û–ø—Ü–∏–∏ –º–µ–Ω—é
OPTIONS="üì∏ –°–Ω–∏–º–æ–∫ –æ–±–ª–∞—Å—Ç–∏ –≤ —Ñ–∞–π–ª
üìã –°–Ω–∏–º–æ–∫ –æ–±–ª–∞—Å—Ç–∏ –≤ –±—É—Ñ–µ—Ä
üñ•Ô∏è –°–Ω–∏–º–æ–∫ –≤—Å–µ–≥–æ —ç–∫—Ä–∞–Ω–∞ –≤ —Ñ–∞–π–ª
üìã –°–Ω–∏–º–æ–∫ –≤—Å–µ–≥–æ —ç–∫—Ä–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä
üé• –ó–∞–ø–∏—Å—å –æ–±–ª–∞—Å—Ç–∏ (MP4)
üé• –ó–∞–ø–∏—Å—å –≤—Å–µ–≥–æ —ç–∫—Ä–∞–Ω–∞ (MP4)
‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å"

CHOICE=$(echo -e "$OPTIONS" | rofi -dmenu -p "Screenshot/Record")

case "$CHOICE" in
  "üì∏ –°–Ω–∏–º–æ–∫ –æ–±–ª–∞—Å—Ç–∏ –≤ —Ñ–∞–π–ª")
    grim -g "$(slurp)" "$FILE"
    notify-send "–°–∫—Ä–∏–Ω—à–æ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω" "$FILE"
    ;;
  "üìã –°–Ω–∏–º–æ–∫ –æ–±–ª–∞—Å—Ç–∏ –≤ –±—É—Ñ–µ—Ä")
    grim -g "$(slurp)" - | wl-copy
    notify-send "–°–∫—Ä–∏–Ω—à–æ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä"
    ;;
  "üñ•Ô∏è –°–Ω–∏–º–æ–∫ –≤—Å–µ–≥–æ —ç–∫—Ä–∞–Ω–∞ –≤ —Ñ–∞–π–ª")
    grim "$FILE"
    notify-send "–°–∫—Ä–∏–Ω—à–æ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω" "$FILE"
    ;;
  "üìã –°–Ω–∏–º–æ–∫ –≤—Å–µ–≥–æ —ç–∫—Ä–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä")
    grim - | wl-copy
    notify-send "–°–∫—Ä–∏–Ω—à–æ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä"
    ;;
  "üé• –ó–∞–ø–∏—Å—å –æ–±–ª–∞—Å—Ç–∏ (MP4)")
    wf-recorder -g "$(slurp)" -f "$DIR/$(date "$DATE_FORMAT").mp4" &
    notify-send "–ù–∞—á–∞—Ç–∞ –∑–∞–ø–∏—Å—å –æ–±–ª–∞—Å—Ç–∏"
    ;;
  "üé• –ó–∞–ø–∏—Å—å –≤—Å–µ–≥–æ —ç–∫—Ä–∞–Ω–∞ (MP4)")
    wf-recorder -f "$DIR/$(date "$DATE_FORMAT").mp4" &
    notify-send "–ù–∞—á–∞—Ç–∞ –∑–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞"
    ;;
  "‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å")
    pkill -INT wf-recorder
    notify-send "–ó–∞–ø–∏—Å—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
    ;;
esac
